<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Đăng ký tham gia</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background: #f4f7f8;
    }

    header {
      background-color: #2c3e50;
      color: white;
      padding: 1rem;
      text-align: center;
    }

    .container {
      max-width: 700px;
      margin: 2rem auto;
      padding: 2rem;
      background: white;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      position: relative;
    }

    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }

    input[type="text"], select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }

    .checkbox-group {
      margin-top: 1rem;
    }

    .checkbox-group input {
      margin-right: 10px;
    }

    button {
      margin-top: 2rem;
      padding: 10px 20px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background-color: #2980b9;
    }

    #participants {
      max-width: 900px;
      margin: 2rem auto;
      background: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }

    th, td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    th {
      background-color: #ecf0f1;
    }

    @media (max-width: 600px) {
      .container, #participants {
        margin: 1rem;
        padding: 1rem;
      }

      table, thead, tbody, th, td, tr {
        display: block;
      }

      td {
        padding-left: 50%;
        position: relative;
      }

      td::before {
        position: absolute;
        top: 12px;
        left: 12px;
        width: 45%;
        white-space: nowrap;
        font-weight: bold;
      }

      td:nth-of-type(1)::before { content: "Họ và tên"; }
      td:nth-of-type(2)::before { content: "Phòng"; }
      td:nth-of-type(3)::before { content: "Trung tâm"; }
    }

    .suggestions-list {
      list-style: none;
      padding: 0;
      margin: 0;
      border: 1px solid #ccc;
      border-top: none;
      max-height: 150px;
      overflow-y: auto;
      position: absolute;
      width: 100%;
      background-color: white;
      z-index: 1000;
    }

    .suggestions-list li {
      padding: 10px;
      cursor: pointer;
    }

    .suggestions-list li:hover {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>

<header>
  <h1>Form Đăng ký Tham gia</h1>
</header>

<div class="container">
  <!-- Họ và tên -->
  <label for="fullname">Họ và tên:</label>
  <input type="text" id="fullname" name="fullname" placeholder="Nhập tên...">
  <ul id="name-suggestions" class="suggestions-list"></ul>

  <!-- Phòng -->
  <label for="department">Phòng:</label>
  <input list="departments" id="department" name="department" placeholder="Nhập tên phòng">
  <datalist id="departments">
    <option value="Phòng Kỹ thuật">
    <option value="Phòng Nhân sự">
    <option value="Phòng Kế toán">
    <option value="Phòng IT">
  </datalist>

  <!-- Trung tâm -->
  <label for="center">Trung tâm:</label>
  <input list="centers" id="center" name="center" placeholder="Chọn trung tâm tương ứng">
  <datalist id="centers">
    <!-- Sẽ được cập nhật động bằng JS -->
  </datalist>

  <!-- Tham gia -->
  <div class="checkbox-group">
    <label>
      <input type="checkbox" id="participate"> Tham gia
    </label>
  </div>

  <button onclick="submitForm()">Gửi</button>
</div>

<!-- Danh sách -->
<div id="participants">
  <h2>Danh sách tham gia</h2>
  <table id="list">
    <thead>
      <tr>
        <th>Họ và tên</th>
        <th>Phòng</th>
        <th>Trung tâm</th>
      </tr>
    </thead>
    <tbody>
      <!-- Danh sách sẽ thêm ở đây -->
    </tbody>
  </table>
</div>

<!-- JavaScript -->
<script>
  // Danh sách tên để gợi ý
  const nameList = [
    "Nguyễn Văn A", "Nguyễn Văn B", "Nguyễn Thị C",
    "Trần Văn D", "Trần Thị E", "Lê Văn F",
    "Lê Thị G", "Phạm Văn H", "Phạm Thị I",
    "Vũ Văn J", "Đặng Thị K", "Hoàng Văn L"
  ];

  const nameInput = document.getElementById("fullname");
  const suggestionBox = document.getElementById("name-suggestions");

  // Gợi ý tên nâng cao
  nameInput.addEventListener("input", function () {
    const inputValue = this.value.toLowerCase();
    suggestionBox.innerHTML = "";

    if (inputValue === "") return;

    const filteredNames = nameList.filter(name =>
      name.toLowerCase().includes(inputValue)
    );

    filteredNames.forEach(name => {
      const li = document.createElement("li");
      li.textContent = name;
      li.addEventListener("click", function () {
        nameInput.value = name;
        suggestionBox.innerHTML = "";
      });
      suggestionBox.appendChild(li);
    });
  });

  // Ẩn gợi ý khi click ra ngoài
  document.addEventListener("click", function (e) {
    if (!nameInput.contains(e.target) && !suggestionBox.contains(e.target)) {
      suggestionBox.innerHTML = "";
    }
  });

  // Gợi ý Trung tâm theo Phòng
  const departmentInput = document.getElementById("department");
  const centerDatalist = document.getElementById("centers");

  const centerMap = {
    "Phòng Kỹ thuật": ["Trung tâm Công nghệ", "Trung tâm Sản xuất"],
    "Phòng Nhân sự": ["Trung tâm Hành chính", "Trung tâm Đào tạo"],
    "Phòng Kế toán": ["Trung tâm Tài chính"],
    "Phòng IT": ["Trung tâm Hạ tầng", "Trung tâm Phần mềm"]
  };

  departmentInput.addEventListener("input", function () {
    const deptValue = this.value.trim();
    const centers = centerMap[deptValue] || [];

    // Xóa gợi ý cũ
    centerDatalist.innerHTML = "";

    // Tạo gợi ý mới
    centers.forEach(center => {
      const option = document.createElement("option");
      option.value = center;
      centerDatalist.appendChild(option);
    });

    // Nếu chỉ có 1 trung tâm -> tự chọn
    if (centers.length === 1) {
      document.getElementById("center").value = centers[0];
    }
  });

  // Xử lý gửi form
  const formData = [];

  function submitForm() {
    const name = nameInput.value.trim();
    const dept = departmentInput.value.trim();
    const center = document.getElementById("center").value.trim();
    const participate = document.getElementById("participate").checked;

    if (!name || !dept || !center) {
      alert("Vui lòng nhập đầy đủ thông tin.");
      return;
    }

    if (!participate) {
      alert("Người này không tham gia.");
      return;
    }

    const data = { name, dept, center };
    formData.push(data);
    updateList();
    clearForm();
  }

  function updateList() {
    const tbody = document.querySelector("#list tbody");
    tbody.innerHTML = "";
    formData.forEach(item => {
      const row = `<tr>
        <td>${item.name}</td>
        <td>${item.dept}</td>
        <td>${item.center}</td>
      </tr>`;
      tbody.innerHTML += row;
    });
  }

  function clearForm() {
    nameInput.value = "";
    departmentInput.value = "";
    document.getElementById("center").value = "";
    document.getElementById("participate").checked = false;
    suggestionBox.innerHTML = "";
  }
</script>

</body>
</html>
